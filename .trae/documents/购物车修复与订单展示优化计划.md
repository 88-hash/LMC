# 🚑 订单状态与购物车紧急修复计划 (Emergency Fix Plan)

**问题确认**:
1.  **订单状态显示"未知"**: 后端创建订单时设置 `status = 0` (Line 95)，但前端 `Order.vue` 只映射了 `1, 2, 3, 4`，导致 `0` 显示为“未知”且无操作按钮。
2.  **购物车加购无反应**: 可能是前端异常捕获不完善，或后端隐式错误（如事务问题复发）。
3.  **核销码展示**: 用户希望直接在订单卡片中显示核销码，而不是点击按钮。

## 🛠️ 修复步骤

### 1. 修复订单状态映射 (`src/views/Order.vue`)
*   **状态修正**: 将 `0` 纳入映射体系。
    *   `getStatusText`: 映射 `0: '待付款'` (或待处理)。
    *   `getStatusType`: 映射 `0: 'danger'`。
*   **按钮逻辑**:
    *   `v-if="o.status === 0 || o.status === 1"` 显示“去支付”。
    *   `v-if="o.status === 2"` 显示“出示核销码”。

### 2. 增强核销码展示 (`src/views/Order.vue`)
*   **UI调整**: 在订单卡片的 `body` 部分（分割线下方），如果 `status === 2`，直接显示核销码区域。
    *   设计一个醒目的框，显示 `Verify Code: 123 456`。
    *   保留“出示核销码”按钮作为备选，或者直接移除按钮，改用卡片内展示。
    *   *响应用户需求*: "下面应该写着出示核销码然后屏幕显示核销码" -> 我将在卡片底部增加一个显眼的区域直接展示码。

### 3. 购物车加购增强 (`src/views/Home.vue`)
*   **调试增强**: 在 `addToCart` 中添加 `console.error` 和 `ElMessage.error`，确保任何错误都能被用户看到。
*   **逻辑检查**: 确保 `goodsId` 和 `quantity` 参数传递正确。

### 4. 流程自测
*   **验证**: 下单 -> 看到“待付款” -> 支付 -> 看到“待核销”及核销码 -> 核销 -> 看到“已完成”。

---
*请批准执行，我将立即修复状态显示和购物车反馈问题。*