# 乐逸零食销售系统前后端分离重构计划

## 1. 架构分离与独立部署

### 1.1 目录结构调整

* 在项目根目录下创建两个新的独立前端项目目录：

  * `client`：专门用于存放和运行C端（客户端）代码。

  * `admin`：专门用于存放和运行B端（管理端）代码。

* 将原 `frontend` 文件夹备份（命名为 `frontend_备份`），以防万一。

### 1.2 代码迁移与清理

* **客户端 (Client)**：

  * 将 `frontend` 内容完整复制到 `client` 目录。

  * 删除 `src/views/admin` 文件夹。

  * 删除 `src/router/modules/admin.js`。

  * 清理 `src/router/index.js` 中关于 admin 的引用和路由守卫逻辑。

  * 清理 `src/components/admin`（如果有）。

* **管理端 (Admin)**：

  * 将 `frontend` 内容完整复制到 `admin` 目录。

  * 删除 `src/views/client` 文件夹。

  * 删除 `src/router/modules/client.js`。

  * 清理 `src/router/index.js` 中关于 client 的引用和路由守卫逻辑。

  * 清理 `src/components/client`。

  * 调整 `src/router/modules/admin.js` 中的路径，可能去除 `/admin` 前缀（使其成为根路径），或保留现状。建议保留现状以减少改动风险，或将 `/admin` 映射为 `/`。考虑到用户习惯，暂时保持 `/admin` 路径，但根路径 `/` 重定向到 `/admin/login`。

### 1.3 配置文件修改

* **Client 项目** (`client/package.json` & `vite.config.js`)：

  * `name`: `leyi-client`

  * 端口: `5173`

  * API 代理: 指向 `http://localhost:8080`

* **Admin 项目** (`admin/package.json` & `vite.config.js`)：

  * `name`: `leyi-admin`

  * 端口: `5174`

  * API 代理: 指向 `http://localhost:8080`

## 2. 系统自测与修复

### 2.1 路由与鉴权修复

* 分别检查两个项目的 `router/index.js`，确保路由守卫（登录拦截）逻辑只包含当前项目相关的部分。

* 确保 `client` 项目访问 `/` 能正常进入首页。

* 确保 `admin` 项目访问 `/` 能跳转到 `/admin/login` 或 `/admin/dashboard`。

### 2.2 功能验证

* 验证客户端：浏览商品、加购、下单、支付、评论。

* 验证管理端：登录、商品管理、订单管理、核销。

## 3. 一键启动与快捷方式

### 3.1 编写启动脚本 (`start.bat`)

* 编写 Windows 批处理脚本，执行以下操作：

  1. 启动后端 Spring Boot 应用 (使用 `mvn spring-boot:run`，路径为 `backend` 目录)。
  2. 启动客户端前端 (使用 `npm run dev`，路径为 `client` 目录)。
  3. 启动管理端前端 (使用 `npm run dev`，路径为 `admin` 目录)。
  4. 等待服务启动（约15-20秒）。
  5. 调用系统浏览器分别打开 `http://localhost:5173` 和 `http://localhost:5174/admin/login`。

### 3.2 创建桌面快捷方式

* 创建一个 VBScript 脚本或使用 PowerShell 来自动在用户桌面生成指向 `start.bat` 的快捷方式。

* 设置快捷方式图标（可选，使用系统默认或项目内图标）。

## 4. 交付物清单

1. **独立目录**：`client/`, `admin/`, `backend/`
2. **启动脚本**：`start.bat`
3. **快捷方式生成器**：`create_shortcut.ps1` (用于生成桌面快捷方式)
4. **说明文档**：`README_DEPLOY.md` (简要说明如何启动)

请确认是否立即开始执行此计划？
