# 🚑 紧急修复计划：C端个人中心与B端权限显示

## 问题诊断
1.  **C端 (Customer)**:
    *   **现象**: 点击头像无响应（缺失下拉菜单），导航栏没有直接的“个人中心”入口。
    *   **原因**: `Layout.vue` 顶部的用户头像区域仅展示了头像和名称，缺少 `el-dropdown` 下拉菜单组件，未配置“个人中心”和“退出登录”的交互逻辑。
2.  **B端 (Admin)**:
    *   **现象**: 店员管理列表仅显示自己（或部分数据），且“新增店员”按钮不可用/不可见。
    *   **原因**:
        *   **数据源问题**: 后端 `AdminMapper.xml` 对应的 `selectAll` 可能未正确映射或被过滤。
        *   **权限逻辑**: 前端 `isManager` 判断逻辑可能存在偏差，或者当前登录账号的 `role` 字段未正确同步到 `localStorage`。
        *   **列表过滤**: 后端 `listAdmins` 可能默认只返回了部分数据，或者前端在展示时有额外的过滤逻辑。

## 修复步骤

### 1. C端前端修复 (`views/Layout.vue`)
- **操作**: 改造顶部导航栏右侧的用户区域。
    - 引入 `el-dropdown` 组件。
    - 添加下拉菜单项：
        - **个人中心**: 跳转至 `/profile`。
        - **退出登录**: 清除 Token 并跳转至 `/login`。
    - 确保未登录状态下显示“登录/注册”按钮。

### 2. B端后端增强 (`AdminController.java`)
- **操作**: 优化 `list` 接口。
    - **安全脱敏**: 遍历返回的管理员列表，将 `password` 字段置为 `null`，防止密码泄露。

### 3. B端前端调试 (`views/admin/AdminManager.vue`)
- **操作**: 检查 `isManager` 计算属性。
    - 确认 `localStorage` 中的 `adminInfo` 是否包含正确的 `role`。
    - 强制刷新列表数据，确保 `tableData` 获取的是全量数据。

### 4. B端布局优化 (`views/admin/Layout.vue`)
- **操作**: 在顶部栏显示当前用户的角色标签（“店长”或“店员”），方便用户确认当前权限身份。

## 验证计划
1.  **C端**: 登录后点击头像，确认出现下拉菜单，点击“个人中心”能跳转。
2.  **B端**: 使用店长账号登录，进入“店员管理”，确认能看到所有账号（包括店员），且“新增店员”按钮可见可用。
